import{_ as k,m as b,b as w,r as c,o as p,c as u,d as e,f as l,g as _,t as n,h as r,F as h,e as S,a as L,w as C,v as E}from"./index-cTZfT-nB.js";import{u as g}from"./cartStore-kxzctltD.js";import{a as T,u as U}from"./axios-YZ117G6_.js";import{L as R}from"./LoadingComponent-RV0Qa-u3.js";var D={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"wei_rio",BASE_URL:"/vue2024_week08/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:q,VITE_PATH:M}=D,N={components:{LoadingComponent:R},data(){return{form:{user:{name:"",email:"",tel:"",address:"",pay:""},message:""}}},methods:{...b(g,["getCart"]),...b(U,["pushMessage"]),onSubmit(){const a=`${q}api/${M}/order`;T.post(a,{data:this.form}).then(s=>{this.$refs.form.resetForm(),this.getCart(),this.pushMessage({style:"success",title:"已建立訂單",content:s.data.message}),this.$router.push(`/order/${s.data.orderId}`)}).catch(s=>{this.pushMessage({style:"danger",title:"無法建立訂單",content:s.response.data.message})})}},computed:{...w(g,["carts","total","isLoading","final_total","couponSuccess"])},mounted(){window.scrollTo({behavior:"smooth",top:0});const a=document.querySelectorAll(".payCheck");a.forEach((s,f)=>{a.forEach((m,o)=>{s.addEventListener("click",()=>{m.classList.remove("payCheck--active"),f===o&&m.classList.add("payCheck--active")})})})}},F={class:"bg-dark text-light py-lg-8 py-5"},j={class:"container"},A=L('<ul class="d-flex justify-content-center align-items-center list-unstyled w-75 mx-auto mb-5"><li class="text-center opacity-50"><p class="mb-0 text-sm fs-xs fs-lg-sm">Step.1</p><p class="mb-0 text-sm fs-xs fs-lg-sm white-space-nowrap">購買項目</p></li><i class="bi bi-chevron-right mx-lg-4 mx-2 mx-md-5"></i><li class="text-center"><p class="mb-0 text-sm fs-xs fs-lg-sm">Step.2</p><p class="mb-0 text-sm fs-xs fs-lg-sm white-space-nowrap">填寫資料</p></li><i class="bi bi-chevron-right mx-lg-4 mx-2 mx-md-5"></i><li class="text-center opacity-50"><p class="mb-0 text-sm fs-xs fs-lg-sm">Step.3</p><p class="mb-0 text-sm fs-xs fs-lg-sm white-space-nowrap">付款資訊</p></li><i class="bi bi-chevron-right mx-lg-4 mx-2 mx-md-5"></i><li class="text-center opacity-50"><p class="mb-0 text-sm fs-xs fs-lg-sm">Step.4</p><p class="mb-0 text-sm fs-xs fs-lg-sm white-space-nowrap">訂單完成</p></li></ul>',1),B=e("i",{class:"bi bi-caret-left-fill"},null,-1),I={class:"row"},P={class:"col-md-8 mb-8 mb-lg-0"},H={class:"d-flex flex-lg-row flex-column justify-content-between mb-4 pb-2 border-bottom"},O={class:"fs-4 mb-lg-0 mb-2"},z={class:"d-flex align-items-center justify-content-between"},G={class:"mb-0 me-3 bg-danger rounded-1 px-2"},J={class:"fs-4 mb-0"},K={class:"ms-3"},Q={class:"list-unstyled"},W=["src"],X={class:"ms-4 d-flex flex-column justify-content-between w-100"},Y={class:"mb-0 fs-5"},Z={class:"d-flex justify-content-between flex-column flex-lg-row"},$={class:"mb-lg-0 mb-3 fs-6"},ee={class:"fs-6 ms-2"},se={class:"mb-0 fs-6"},te={class:"ms-2"},oe={class:"col-md-4"},le={class:"rounded-2 shadow-lg-lg"},ae=e("p",{class:"fs-4 pb-2 border-bottom border-light border-opacity-10"}," 寄送資訊 ",-1),re={class:"mb-3"},ne=e("label",{for:"email",class:"form-label"},[e("span",{class:"text-danger"},"*"),r(" Email ")],-1),ie={class:"mb-3"},de=e("label",{for:"name",class:"form-label"},[e("span",{class:"text-danger"},"*"),r(" 收件人姓名 ")],-1),ce={class:"mb-3"},me=e("label",{for:"tel",class:"form-label"},[e("span",{class:"text-danger"},"*"),r(" 收件人電話 ")],-1),pe={class:"mb-3"},ue=e("label",{for:"address",class:"form-label"},[e("span",{class:"text-danger"},"*"),r(" 收件人地址 ")],-1),fe={class:"mb-3"},be=e("p",null,[e("span",{class:"text-danger me-1"},"*"),r("選擇付款方式")],-1),_e={class:"row"},he={class:"payCheck p-0 col form-check text-center btn btn-outline-light border-0"},ge=e("label",{class:"form-check-label w-100 p-2",for:"flexRadioDefault1",style:{cursor:"pointer"}},[e("i",{class:"bi bi-credit-card fs-2"}),e("p",{class:"mb-0"},"信用卡")],-1),xe={class:"payCheck p-0 col form-check text-center btn btn-outline-light border-0"},ye=e("label",{class:"form-check-labe w-100 p-2",for:"flexRadioDefault2",style:{cursor:"pointer"}},[e("i",{class:"bi bi-box-seam fs-2"}),e("p",{class:"mb-0"},"超商繳費")],-1),ve={class:"mb-3"},Ve=e("label",{for:"message",class:"form-label"},"留言",-1),ke=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger text-light w-100"}," 提交訂單 ")],-1);function we(a,s,f,m,o,x){const y=c("RouterLink"),i=c("VField"),d=c("ErrorMessage"),v=c("VForm"),V=c("LoadingComponent");return p(),u(h,null,[e("div",F,[e("section",null,[e("div",j,[A,l(y,{to:"/cart",class:"btn btn-outline-light rounded-pill text-decoration-none mb-4 d-inline-block"},{default:_(()=>[B,r("返回購物車")]),_:1}),e("div",I,[e("div",P,[e("div",H,[e("p",O,"目前有 "+n(a.carts.length)+" 部",1),e("div",z,[e("p",G,"已折抵 - NT$ "+n(a.total-a.final_total),1),e("p",J,[r("總金額："),e("span",K,"NT$ "+n(a.final_total),1)])])]),e("ul",Q,[(p(!0),u(h,null,S(a.carts,t=>(p(),u("li",{class:"d-flex mb-lg-4 mb-5",key:t.id},[e("img",{src:t.product.imageUrl,alt:"",style:{width:"100px","object-fit":"cover"}},null,8,W),e("div",X,[e("p",Y,n(t.product.title),1),e("div",Z,[e("p",$,[r("NT$ "+n(t.product.price)+" ",1),e("span",null,"x "+n(t.qty),1),e("span",ee," / "+n(t.product.unit),1)]),e("p",se,[r("總計：NT$ "),e("span",te,n(t.final_total),1)])])])]))),128))])]),e("div",oe,[e("div",le,[ae,l(v,{ref:"form",onSubmit:x.onSubmit},{default:_(()=>[e("div",re,[ne,l(i,{id:"email",type:"email",class:"form-control border-dark border-opacity-40 rounded-0",placeholder:"請輸入 Email",name:"email",rules:"required|email",modelValue:o.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=t=>o.form.user.email=t)},null,8,["modelValue"]),l(d,{name:"email",class:"bg-danger rounded-1 px-1 mt-2 d-inline-block"})]),e("div",ie,[de,l(i,{id:"name",type:"text",class:"form-control border-dark border-opacity-40 rounded-0",placeholder:"請輸入姓名",name:"姓名",rules:"required",modelValue:o.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=t=>o.form.user.name=t)},null,8,["modelValue"]),l(d,{name:"姓名",class:"bg-danger rounded-1 px-1 mt-2 d-inline-block"})]),e("div",ce,[me,l(i,{id:"tel",type:"tel",class:"form-control border-dark border-opacity-40 rounded-0",placeholder:"請輸入電話",name:"電話",rules:"required|min:8|max:10",modelValue:o.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=t=>o.form.user.tel=t)},null,8,["modelValue"]),l(d,{name:"電話",class:"bg-danger rounded-1 px-1 mt-2 d-inline-block"})]),e("div",pe,[ue,l(i,{id:"address",type:"text",class:"form-control border-dark border-opacity-40 rounded-0",placeholder:"請輸入地址",name:"地址",rules:"required",modelValue:o.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=t=>o.form.user.address=t)},null,8,["modelValue"]),l(d,{name:"地址",class:"bg-danger rounded-1 px-1 mt-2 d-inline-block"})]),e("div",fe,[be,e("div",_e,[e("div",he,[l(i,{class:"form-check-input d-none",rules:"required",type:"radio",name:"付款方式",value:"信用卡",id:"flexRadioDefault1",modelValue:o.form.user.pay,"onUpdate:modelValue":s[4]||(s[4]=t=>o.form.user.pay=t)},null,8,["modelValue"]),ge]),e("div",xe,[l(i,{class:"form-check-input d-none",rules:"required",type:"radio",name:"付款方式",value:"超商繳費",id:"flexRadioDefault2",modelValue:o.form.user.pay,"onUpdate:modelValue":s[5]||(s[5]=t=>o.form.user.pay=t)},null,8,["modelValue"]),ye])]),l(d,{name:"付款方式",class:"bg-danger rounded-1 px-1 mt-2 d-inline-block"})]),e("div",ve,[Ve,C(e("textarea",{id:"message",class:"form-control border-dark border-opacity-40 rounded-0",cols:"30",rows:"10","onUpdate:modelValue":s[6]||(s[6]=t=>o.form.message=t)},null,512),[[E,o.form.message]])]),ke]),_:1},8,["onSubmit"])])])])])])]),l(V,{active:a.isLoading,"onUpdate:active":s[7]||(s[7]=t=>a.isLoading=t),id:"checkoutPage"},null,8,["active"])],64)}const Te=k(N,[["render",we]]);export{Te as default};
